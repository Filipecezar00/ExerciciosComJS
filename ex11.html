<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Carteira Digital</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<style>
    .valor-positivo{
        color: green;
    }
    .valor-negativo{
        color: red;
    }
</style>
<body class="bg-light">
    <div class="container mt-5">
        <h1 class="text-center mb-4">Carteira Digital</h1>
        <div class="card text-center mb-4 shadow-sm">
            <div class="card-body">
                <h3>Saldo Atual</h3>
                <h1 id="saldo_atual">R$ 0,00</h1>
            </div>
        </div>
        <div class="card mb-4">
            <div class="card-header">Nova Transação</div>
            <div class="card-body">
                <form id="form">
                    <div class="row">
                        <div class="col-md-5 mb-2">
                            <input type="text" id="descricao" class="form-control" placeholder="Aluguel" required>
                        </div>
                        <div class="col-md-3 mb-2">
                            <input type="number" id="valor" class="form-control" placeholder="0,00" step="0.01" required>
                        </div>
                        <div class="col-md-3 mb-2">
                            <select id="tipo" class="form-select">
                                <option value="entrada">Entrada</option>
                                <option value="saida">Saída</option>
                            </select>
                        </div>
                        <div class="col-md-1 mb-2">
                            <button class="btn btn-primary w-100" id="btn_enviar">+</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
        <h4>Histórico</h4>
        <ul id="lista_transacoes" class="list-group"></ul>
        <button id="btn_limpar" class="btn btn-outline-secondary btn-sm mt-3">Limpar Historico</button>
    </div>
    <script>
        const descricao = document.getElementById("descricao")
        const valor = document.getElementById("valor")
        const tipo = document.getElementById("tipo") 
        const formulario = document.getElementById("form")
        const lista = document.getElementById("lista_transacoes")
        const btn_limpar = document.getElementById("btn_limpar")
        const saldo = document.getElementById("saldo_atual")
        const btn_enviar = document.getElementById("btn_enviar")

        atualizarTela()

        btn_enviar.addEventListener("click",(e)=>{
            e.preventDefault()
            addTransacao()
        })

        function addTransacao(){
            let conta = descricao.value 
            let valorConta = Number(valor.value)

            const transacao={
                desc:conta, 
                preco:valorConta, 
                modo:tipo.value
            }
            let transacoes = JSON.parse(localStorage.getItem("transacao")) || [] 
            transacoes.push(transacao) 
            localStorage.setItem("transacao",JSON.stringify(transacoes))

            formulario.reset()

            atualizarTela() 
        }
        
        function atualizarTela(){
        lista.innerHTML =""
        let saldoTotal = 0  
        let transacoes = JSON.parse(localStorage.getItem("transacao")) || [] 
        let ValorSaldo = saldo.value 

            transacoes.forEach(transacao =>{
                let classeCor
                if(transacao.modo=="entrada"){
                    saldoTotal+= transacao.preco 
                    classeCor="valor-positivo"
                }else if(transacao.modo=="saida"){
                     saldoTotal-=transacao.preco 
                     classeCor="valor-negativo"
                }
                lista.innerHTML+=`
                <div class="card mb-2">
                    <div class="card-body">
                        <h5>${transacao.desc}</h5>
                        <h6 class="${classeCor}">R$: ${transacao.preco.toFixed(2)}</h6>
                        <small>${transacao.modo.toUpperCase()}</small>
                    </div>
                </div>
                `
            });
            saldo.innerText =`R$ ${saldoTotal.toFixed(2)}`
        }

        btn_limpar.addEventListener("click",(transacao)=>{
            let transacoes = JSON.parse(localStorage.getItem("transacao")) || []
            lista.innerHTML=""
            localStorage.removeItem("transacao")
            atualizarTela()
        })

    </script>
</body>
</html>